function isset(e){return e!==void 0&&null!==e}function Ajax(e,t){this.post=[],this.elm=void 0,this.loader=void 0,e&&(this.elm=e,this.loader=document.createElement("span"),this.loader.className="loading",this.loader.innerHTML='<i class="n1"></i><i class="n2"></i><i class="n3"></i>',this.elm.parentNode.replaceChild(this.loader,this.elm)),this.post.push("action="+t),this.post.push("page="+page),this.addParam=function(e,t){this.post.push(e+"="+encodeURIComponent(t))},this.send=function(e,t){var n=this,o=new XMLHttpRequest;o.open("POST",ajax_url),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(this.post.join("&")),o.onreadystatechange=function(){if(o.readyState==o.DONE){if(200==o.status){var a=JSON.parse(o.responseText);"success"==a.status?e!==void 0&&e(a):t!==void 0&&t(a)}else 403==o.status?alert(m_error_login):alert(m_error_ajax);n.cancel()}}},this.cancel=function(){this.loader&&this.loader.parentNode.replaceChild(this.elm,this.loader)}}function onload_tags(){function e(){for(var e=i.querySelectorAll(".tag"),t=[],n=0;e.length>n;n++)t.push(e[n].innerHTML);r.value=t.join(",")}function t(t){return t.target.parentNode.removeChild(t.target),e(),!1}function n(e){var n=document.createElement("a");n.href="#",n.className="tag",n.innerHTML=e,l.appendChild(n),n.onclick=t}function o(){""!==s.value&&(n(s.value),s.value="",e())}function a(){if(""!==r.value)for(var e=r.value.split(/,/),t=0;e.length>t;t++)n(e[t])}var i=document.querySelector(".editTags"),l=i.querySelector("span"),r=document.getElementById("tags"),s=document.getElementById("addTag"),u=document.querySelector(".pick-tag"),d=u.querySelectorAll("span"),c=!1;u.onmousedown=function(e){"visible"==e.target.className&&(s.value=e.target.innerHTML,o(),c=!0)},s.onkeydown=function(e){if("keyCode"in e&&(13==e.keyCode||188==e.keyCode)||"key"in e&&("Enter"==e.key||","==e.key))return o(),s.blur(),s.focus(),!1;if("keyCode"in e&&9==e.keyCode||"key"in e&&"Tab"==e.key){var t=form.list.querySelector(".visible");return null!==t&&(s.value=t.innerHTML,o(),s.blur(),s.focus()),!1}},s.onfocus=function(){var e=s.getBoundingClientRect();u.style.left=e.left+"px",u.style.top=e.bottom+"px",s.onkeyup()},s.onblur=function(){c?(c=!1,setTimeout("document.getElementById('addTag').focus()",10)):(u.style.left="-9999px",u.style.top="-9999px")},s.onkeyup=function(){for(var e=s.value,t=0;d.length>t;t++)d[t].className=-1===d[t].innerHTML.indexOf(e)?"":"visible"},r.onupdate=a,a()}function load(e,t){var n=new Ajax(void 0,"load");n.addParam("album",e),n.addParam("filename",t),n.send(function(e){document.querySelector("article").innerHTML=e.html,document.querySelector(".img-display").style="max-height:"+Math.max(window.outerHeight-200,200)+"px";var t=document.querySelectorAll(".div-actions-top a");t.length>1&&(t[0].href=e.url)})}isset(document.getElementById("logout"))&&(document.getElementById("logout").onclick=function(){return document.getElementById("form-logout").submit(),!1}),isset(document.querySelector(".editTags"))&&onload_tags();var imgDisplay=document.querySelector(".img-display");isset(imgDisplay)&&(imgDisplay.style="max-height:"+Math.max(window.outerHeight-200,200)+"px");